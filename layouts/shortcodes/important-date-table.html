{{ $csv := .Get 0 }}
{{ $separator := .Get 1 | default "," }}

{{ $resource := resources.Get $csv }}
{{ $data := $resource | transform.Unmarshal (dict "delimiter" $separator) }}

<div class="split">
    <table style="width: 100%; table-layout: auto;">
        <tbody>
            {{ range $row := $data }}
            {{ $isDue := and (gt (len $row) 2) (eq (index $row 2) "due") }}
            <tr{{ if $isDue }} class="due"{{ end }}>
                {{ range $index, $cell := $row }}
                {{ if eq $index 0 }}
                    <td><strong>{{ . }}</strong></td>
                {{ else if ne $index 2 }}
                    <td>{{ . }}</td>
                {{ end }}
                {{ end }}
            </tr>
            {{ end }}
        </tbody>
    </table>
</div>

<style>
.split table td {
    white-space: nowrap;
    padding-right: 1em;
    min-width: 120px;
}
.split table td:last-child {
    width: 100%;
    white-space: normal;
}
</style>
