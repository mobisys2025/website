<!-- Image with Reference Shortcode -->
{{ $src := .Get "src" }}
{{ $title := .Get "title" | default "" }}
{{ $alt := $title | default "Image" }}
{{ $ref := .Get "ref" | default "" }}
{{ $refURL := .Get "refURL" | default "" }}
{{ $width := .Get "width" | default "100%" }}

{{ if not $src }}
{{ warnf "No image source provided for image_with_ref shortcode." }}
{{ end }}

<div class="image-with-ref">
    <img src="{{ $src }}" alt="{{ $alt }}" style="max-width: {{ $width }}; height: auto;" />
    {{ if or $title $ref }}
    <div class="image-info">
        {{ if $title }}
        <div class="image-title">
            {{ $title }}
        </div>
        {{ end }}
        {{ if $ref }}
        <div class="image-ref">
            Source: 
            {{ if $refURL }}
            <a href="{{ $refURL }}" target="_blank" rel="noopener noreferrer">{{ $ref }}</a>
            {{ else }}
            {{ $ref }}
            {{ end }}
        </div>
        {{ end }}
    </div>
    {{ end }}
</div>